<script>
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.getElementById('product-container');
        const repoOwner = "giglifegamingaz";
        const repoName = "giglife-gaming-site";

        // 1. Scan the folder on GitHub for all product files
        fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/content/products`)
            .then(res => res.json())
            .then(async (files) => {
                container.innerHTML = "";
                
                // Filter to only look for .json files
                const jsonFiles = files.filter(file => file.name.endsWith('.json'));

                for (const file of jsonFiles) {
                    // 2. Fetch the data inside each file
                    const res = await fetch(file.download_url);
                    const item = await res.json();
                    
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    const rawPrice = item.price.replace(/[^0-9.]/g, '');
                    
                    card.innerHTML = `
                        <img src="${item.image}" alt="${item.title}">
                        <h2 style="color:var(--cyan); margin:0; text-transform: uppercase;">${item.title}</h2>
                        <div class="price-text">$${rawPrice}</div>
                        <div class="description-text">${item.body}</div>
                        <a href="https://cash.app/$giglifegaming/${rawPrice}" target="_blank" class="buy-btn">ðŸ’¸ Buy Now via Cash App</a>
                    `;
                    container.appendChild(card);
                }
            })
            .catch(err => {
                container.innerHTML = "<p>Ready to add products! Use the Admin Dashboard to create your first listing.</p>";
            });
    });
</script>
